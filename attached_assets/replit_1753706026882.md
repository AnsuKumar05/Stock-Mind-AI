# AI Stock Market Analyzer

## Overview

This is a Flask-based web application that provides AI-powered stock market analysis and prediction capabilities. Users can upload CSV files containing historical stock data and receive machine learning-powered predictions for future stock prices. The application features user authentication, file upload management, and a comprehensive dashboard for tracking predictions.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture
- **Template Engine**: Jinja2 templates with Flask
- **UI Framework**: Bootstrap 5 with dark theme
- **Icons**: Font Awesome 6.0
- **Responsive Design**: Mobile-first approach with Bootstrap grid system
- **Client-side Interactions**: Minimal JavaScript, primarily Bootstrap components

### Backend Architecture
- **Web Framework**: Flask (Python)
- **Database ORM**: SQLAlchemy with DeclarativeBase
- **Session Management**: Flask sessions with secure cookie-based storage
- **File Handling**: Werkzeug utilities for secure file uploads
- **Authentication**: Password hashing with Werkzeug security utilities

### Machine Learning Architecture
- **ML Framework**: scikit-learn
- **Model Type**: Linear Regression with StandardScaler
- **Data Processing**: pandas for CSV handling and feature engineering
- **Prediction Pipeline**: Automated feature extraction from time series data

## Key Components

### Database Models
1. **User Model** (users table): Manages user authentication with email-based login
2. **Upload Model** (uploads table): Tracks uploaded CSV files with metadata and timestamps
3. **Prediction Model** (predictions table): Stores ML prediction results, confidence scores, and detailed analysis

### Core Modules
1. **app.py**: Main Flask application with route definitions and middleware
2. **models.py**: SQLAlchemy database models and relationships
3. **ml_predictor.py**: StockPredictor class for machine learning operations
4. **main.py**: Application entry point

### Template Structure
- **base.html**: Master template with navigation and common layout
- **index.html**: Landing page with feature overview
- **login.html/register.html**: Authentication forms
- **dashboard.html**: User statistics and prediction history
- **upload.html**: File upload interface with requirements
- **prediction_results.html**: ML prediction display

## Data Flow

1. **Email-based Authentication**: Users login with email (auto-creates account if new)
2. **Easy Upload**: Users upload CSV files via simple form interface
3. **AI Predictions**: ML model analyzes data and generates predictions
4. **Detailed Analysis**: System shows predicted price, trend direction, and confidence
5. **History Tracking**: All uploads and predictions stored for user review

### Recent Changes (July 27, 2025)
- **Currency Conversion**: All dollar values converted to Indian Rupees (₹) using 1 USD = 83 INR
- **Home Navigation**: Home button now always shows login UI (not dashboard after predictions)
- **Linear Regression Improvements**: Enhanced model to use Date as ordinal and proper features
- **Real Price Calculations**: Fixed confidence rate based on R² score, removed placeholder values
- **Accurate Trend Analysis**: Price Change and Percentage Change now show real differences
- **INR Formatting**: All prices displayed with ₹ symbol and comma separators (e.g., ₹1,23,456.78)
- **Model Metrics**: Shows proper R² Score, MSE, and total data points used

## External Dependencies

### Python Packages
- **Flask**: Web framework and routing
- **SQLAlchemy**: Database ORM and migrations
- **pandas**: Data manipulation and CSV processing
- **scikit-learn**: Machine learning algorithms and preprocessing
- **Werkzeug**: Security utilities and file handling

### Frontend Dependencies
- **Bootstrap 5**: UI framework via CDN
- **Font Awesome 6**: Icon library via CDN
- **Custom CSS**: Application-specific styling

### Infrastructure
- **Database**: SQLite (default) with PostgreSQL support via DATABASE_URL
- **File Storage**: Local filesystem for uploaded CSV files
- **Session Storage**: Encrypted cookies for user sessions

## Deployment Strategy

### Environment Configuration
- **Database URL**: Configurable via DATABASE_URL environment variable
- **Secret Key**: SESSION_SECRET environment variable for production
- **File Uploads**: Configurable upload directory with size limits
- **Debug Mode**: Enabled for development, should be disabled in production

### Production Considerations
- **Proxy Support**: ProxyFix middleware for reverse proxy deployments
- **Database Connection**: Pool management with recycle and pre-ping
- **File Security**: Secure filename handling and size restrictions
- **Logging**: Configurable logging levels for monitoring

### Scalability Features
- **Database Pooling**: Connection pool management for concurrent users
- **File Size Limits**: 16MB maximum upload size to prevent abuse
- **Session Management**: Stateless design with cookie-based sessions
- **Model Persistence**: Trained models can be cached for performance

The application is designed for deployment on platforms like Replit, Heroku, or similar PaaS providers with minimal configuration requirements.